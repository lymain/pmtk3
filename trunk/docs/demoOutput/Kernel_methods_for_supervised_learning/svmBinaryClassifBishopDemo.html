
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>Compare SVM and kernelized logreg on synthetic 2 class data in 2d</title><meta name="generator" content="MATLAB 7.10"><meta name="date" content="2010-05-01"><meta name="m-file" content="svmBinaryClassifBishopDemo"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h1>Compare SVM and kernelized logreg on synthetic 2 class data in 2d</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Load  Data</a></li><li><a href="#2">Set up kernels</a></li><li><a href="#3">Train and test</a></li></ul></div><h2>Load  Data<a name="1"></a></h2><p>Load synthetic data generated from a mixture of 2 Gaussians. Source: <a href="http://research.microsoft.com/~cmbishop/PRML/webdatasets/datasets.htm">http://research.microsoft.com/~cmbishop/PRML/webdatasets/datasets.htm</a></p><pre class="codeinput">load <span class="string">bishop2class</span>
y = Y(:);

<span class="comment">%X = mkUnitVariance(centerCols(X));</span>
</pre><h2>Set up kernels<a name="2"></a></h2><p>We pick  hyperparameters that result in a pretty plot</p><pre class="codeinput">lambda = 2;
rbfScale = 0.3;
gamma = 1/(2*rbfScale^2);
kernelFn = @kernelRbfSigma;
Ktrain =  kernelFn(X, X, rbfScale);

logregArgs.lambda = lambda;
logregArgs.regType = <span class="string">'L2'</span>;
logregArgs.kernelFn = @kernelRbfSigma;
logregArgs.kernelParam = rbfScale;


<span class="comment">%[model, bestParams, cvMU, cvSigma] = svmlightFitCV(X, y);</span>
</pre><h2>Train and test<a name="3"></a></h2><pre class="codeinput"><span class="keyword">for</span> method=1:4
    <span class="keyword">switch</span> method
        <span class="keyword">case</span> 1,
            model = logregFit(X, y, logregArgs);
            fname = <span class="string">'logregL2'</span>;
            predictFn = @(Xtest) logregPredict(model, Xtest);
        <span class="keyword">case</span> 2,
            logregArgs.regType = <span class="string">'L1'</span>;
            model = logregFit(X, y, logregArgs);
            SV = (abs(model.w) &gt; 1e-5);
            fname = <span class="string">'logregL1'</span>;
            predictFn = @(Xtest) logregPredict(model, Xtest);
        <span class="keyword">case</span> 3
            C = 1/lambda;
            tic
            model = svmFit(X, y,<span class="string">'kernel'</span>, kernelFn,<span class="string">'C'</span>, C, <span class="string">'kernelParam'</span>, rbfScale);
            toc
            fname = <span class="string">'SVM'</span>;
            predictFn = @(Xtest) svmPredict(model, Xtest);
            yhat = svmPredict(model, X);
            trainingErrorsSVM = sum(yhat ~= convertLabelsToPM1(y))
            SVsvm = model.svi;
        <span class="keyword">case</span> 4
            C = 1 / lambda;
            gamma = 1/(2*rbfScale^2);
            tic
            modelLight = svmFit(X, y,<span class="string">'C'</span>, C,<span class="string">'kernel'</span>, <span class="string">'rbf'</span>, <span class="string">'kernelParam'</span>, gamma, <span class="string">'fitFn'</span>, @svmlightFit);
            toc
            SV = modelLight.svi;
            fname = <span class="string">'SVMlight'</span>;
            predictFn = @(Xtest)svmPredict(modelLight, Xtest);
            yhat = svmPredict(modelLight, X);
            trainingErrorsSVMlight = sum(yhat ~= convertLabelsToPM1(y))
    <span class="keyword">end</span>
    <span class="comment">% Plot results</span>
    plotDecisionBoundary(X, y, predictFn, <span class="string">'symbols'</span>, <span class="string">'+x'</span>);
    <span class="keyword">if</span> method &gt; 1
        plot(X(SV,1), X(SV,2), <span class="string">'ok'</span>, <span class="string">'linewidth'</span>, 1.5, <span class="string">'markersize'</span>, 12);
    <span class="keyword">end</span>
    title(sprintf(<span class="string">'%s'</span>, fname))
    printPmtkFigure(sprintf(<span class="string">'svmBinaryClassifDemo%s'</span>, fname))
<span class="keyword">end</span>
</pre><pre class="codeoutput">  iter fEvals         stepLen            f(w)  free
     1      2    1.00000e+000    1.36275e+002   136
     2      3    4.76638e+000    1.30325e+002   136
     3      4    1.86489e+000    1.29142e+002   132
     4      5    2.06528e+000    1.28215e+002   125
     5      6    1.67158e+000    1.27712e+002   114
     6      7    1.51366e+000    1.27486e+002   103
     7      8    1.17649e+000    1.27230e+002    94
     8      9    1.55917e+000    1.27032e+002    95
     9     10    5.98006e-001    1.26930e+002    84
    10     11    1.08536e+000    1.26809e+002    82
    11     12    7.62576e-001    1.26734e+002    77
    12     13    9.81013e-001    1.26633e+002    75
    13     14    8.14973e-001    1.26554e+002    72
    14     15    8.44431e-001    1.26469e+002    69
    15     16    8.52927e-001    1.26421e+002    65
    16     17    6.70528e-001    1.26395e+002    58
    17     18    4.83381e-001    1.26367e+002    65
    18     19    4.87452e-001    1.26345e+002    59
    19     20    1.09051e+000    1.26330e+002    57
    20     21    4.21565e-001    1.26310e+002    53
    21     22    2.68891e-001    1.26292e+002    53
    22     23    7.21499e-001    1.26271e+002    52
    23     24    7.12906e-001    1.26256e+002    52
    24     25    7.27137e-001    1.26236e+002    48
    25     26    8.05076e-001    1.26215e+002    45
    26     27    3.88489e-001    1.26195e+002    43
    27     28    2.88911e-001    1.26184e+002    43
    28     29    6.35175e-001    1.26166e+002    43
    29     30    9.50138e-001    1.26151e+002    44
    30     31    2.36886e-001    1.26137e+002    41
    31     32    3.90048e-001    1.26126e+002    41
    32     33    4.19600e-001    1.26119e+002    40
    33     34    1.36166e-001    1.26114e+002    39
    34     35    2.95966e-001    1.26107e+002    40
    35     36    3.25788e-001    1.26099e+002    40
    36     37    4.91060e-001    1.26091e+002    42
    37     38    6.01398e-001    1.26078e+002    41
    38     39    8.51382e-001    1.26060e+002    40
    39     40    4.91925e-001    1.26049e+002    39
    40     41    8.35121e-001    1.26037e+002    39
    41     42    2.11063e-001    1.26031e+002    37
    42     43    3.14041e-001    1.26025e+002    35
    43     44    1.45180e-001    1.26022e+002    35
    44     45    2.67797e-001    1.26016e+002    35
    45     46    2.30103e-001    1.26012e+002    36
    46     47    2.01545e-001    1.26009e+002    36
    47     48    2.66903e-001    1.26006e+002    34
    48     49    2.57854e-001    1.26004e+002    34
    49     50    3.37480e-001    1.25998e+002    32
    50     51    4.96917e-001    1.25994e+002    32
    51     52    5.27525e-001    1.25993e+002    30
    52     53    4.34657e-001    1.25989e+002    33
    53     54    1.01038e-001    1.25987e+002    31
    54     55    1.55054e-001    1.25985e+002    31
    55     56    2.35525e-001    1.25982e+002    31
    56     57    2.91128e-001    1.25980e+002    30
    57     58    1.06943e-001    1.25980e+002    31
    58     59    1.82580e-001    1.25978e+002    31
    59     60    1.56690e-001    1.25977e+002    30
    60     61    1.68130e-001    1.25976e+002    30
    61     62    1.60888e-001    1.25975e+002    31
    62     63    1.10652e-001    1.25973e+002    30
    63     64    2.22568e-001    1.25971e+002    30
    64     65    1.26191e-001    1.25970e+002    29
    65     66    1.91114e-001    1.25968e+002    28
    66     67    1.74724e-001    1.25968e+002    27
    67     68    1.07878e-001    1.25967e+002    25
    68     69    1.17485e-001    1.25966e+002    25
    69     70    2.06071e-001    1.25964e+002    25
    70     71    1.16961e-001    1.25964e+002    25
    71     72    1.20359e-001    1.25963e+002    25
    72     73    1.61946e-001    1.25962e+002    25
    73     74    1.65122e-001    1.25961e+002    25
    74     75    1.20473e-001    1.25960e+002    25
    75     76    1.35443e-001    1.25960e+002    25
    76     78    5.82474e-002    1.25960e+002    23
    77     79    4.62764e-002    1.25959e+002    24
    78     80    5.55379e-002    1.25959e+002    24
    79     81    2.53578e-002    1.25959e+002    24
    80     82    6.81443e-002    1.25959e+002    24
    81     83    8.01147e-002    1.25958e+002    24
    82     84    6.59915e-002    1.25958e+002    23
    83     85    2.43867e-002    1.25958e+002    23
    84     86    2.65438e-002    1.25958e+002    23
    85     87    2.74909e-002    1.25958e+002    23
    86     88    3.94566e-002    1.25958e+002    23
    87     89    3.62106e-002    1.25957e+002    23
    88     90    3.20973e-002    1.25957e+002    23
    89     91    2.98375e-002    1.25957e+002    23
    90     92    4.98534e-002    1.25957e+002    23
    91     93    9.65608e-002    1.25957e+002    24
    92     94    5.07302e-002    1.25957e+002    22
    93     95    1.75695e-002    1.25957e+002    22
    94     96    2.56892e-002    1.25956e+002    22
    95     97    1.30764e-002    1.25956e+002    22
    96     98    9.41703e-003    1.25956e+002    21
    97     99    8.38892e-003    1.25956e+002    21
    98    100    4.04880e-002    1.25956e+002    21
    99    101    2.39666e-002    1.25956e+002    21
   100    102    2.46935e-002    1.25956e+002    21
   101    103    3.28878e-002    1.25956e+002    21
   102    104    4.20899e-002    1.25956e+002    21
   103    105    8.90945e-002    1.25956e+002    21
   104    106    8.55041e-002    1.25956e+002    21
   105    107    5.34814e-002    1.25956e+002    21
   106    108    1.71747e-002    1.25956e+002    20
   107    109    3.25233e-002    1.25955e+002    20
   108    110    2.34248e-002    1.25955e+002    21
   109    111    2.48683e-002    1.25955e+002    20
   110    112    6.58297e-003    1.25955e+002    20
   111    113    9.39593e-003    1.25955e+002    20
   112    114    8.84667e-003    1.25955e+002    20
   113    115    1.36805e-002    1.25955e+002    20
   114    116    1.48834e-002    1.25955e+002    20
   115    117    5.39284e-003    1.25955e+002    20
   116    118    5.62509e-003    1.25955e+002    19
   117    119    5.64668e-003    1.25955e+002    19
   118    120    6.81623e-003    1.25955e+002    19
   119    121    6.32618e-003    1.25955e+002    19
   120    122    4.26746e-003    1.25955e+002    19
   121    123    3.80227e-003    1.25955e+002    19
   122    124    5.56014e-003    1.25955e+002    19
   123    125    9.37206e-003    1.25955e+002    19
   124    126    1.18451e-002    1.25955e+002    19
   125    127    8.74707e-003    1.25955e+002    19
   126    128    4.11133e-003    1.25955e+002    20
   127    129    3.25552e-003    1.25955e+002    20
   128    130    5.00456e-003    1.25955e+002    20
   129    131    8.09769e-003    1.25955e+002    20
   130    132    9.44084e-003    1.25955e+002    20
   131    133    3.22353e-003    1.25955e+002    19
   132    134    2.35226e-003    1.25955e+002    19
Function value change too small
  iter fEvals         stepLen            f(w)  free
     1      2    1.00000e+000    1.09290e+002    87
     2      3    3.93880e+000    1.06067e+002    87
     3      4    1.20302e+000    1.05590e+002    81
     4      5    2.06369e+000    1.05200e+002    79
     5      6    7.63377e-001    1.04953e+002    68
     6      7    2.25714e+000    1.04653e+002    65
     7      8    5.19898e-001    1.04550e+002    54
     8      9    1.09949e+000    1.04430e+002    52
     9     10    1.43238e+000    1.04327e+002    48
    10     11    5.62639e-001    1.04280e+002    41
    11     12    6.12882e-001    1.04224e+002    40
    12     13    3.82849e-001    1.04188e+002    41
    13     14    6.23083e-001    1.04144e+002    39
    14     15    3.32721e-001    1.04130e+002    38
    15     16    5.37902e-001    1.04110e+002    37
    16     17    5.83475e-001    1.04084e+002    35
    17     18    1.44885e+000    1.04040e+002    33
    18     19    4.77574e-001    1.04016e+002    29
    19     20    3.81775e-001    1.04003e+002    31
    20     21    9.68449e-001    1.03973e+002    31
    21     22    3.45593e-001    1.03969e+002    27
    22     23    3.07258e-001    1.03964e+002    28
    23     24    5.59501e-001    1.03955e+002    28
    24     25    2.98436e-001    1.03947e+002    24
    25     26    6.01979e-001    1.03936e+002    23
    26     27    1.01971e-001    1.03933e+002    23
    27     28    2.62901e-001    1.03926e+002    23
    28     29    1.99862e-001    1.03924e+002    24
    29     30    3.39166e-001    1.03923e+002    22
    30     31    1.65076e-001    1.03921e+002    23
    31     32    1.05258e-001    1.03920e+002    23
    32     33    1.64050e-001    1.03917e+002    23
    33     34    1.95208e-001    1.03914e+002    22
    34     35    2.11822e-001    1.03911e+002    23
    35     36    2.39915e-001    1.03908e+002    22
    36     37    2.02809e-001    1.03906e+002    22
    37     38    1.78669e-001    1.03904e+002    22
    38     39    1.26033e-001    1.03903e+002    23
    39     40    1.77916e-001    1.03902e+002    22
    40     41    1.54582e-001    1.03900e+002    22
    41     42    1.41327e-001    1.03899e+002    22
    42     43    1.09336e-001    1.03898e+002    21
    43     44    5.80513e-002    1.03898e+002    21
    44     45    5.54481e-002    1.03898e+002    21
    45     46    9.81309e-002    1.03898e+002    20
    46     47    6.76685e-002    1.03897e+002    21
    47     48    3.92381e-002    1.03897e+002    19
    48     49    5.91710e-002    1.03897e+002    19
    49     50    4.22160e-002    1.03897e+002    19
    50     51    3.59856e-002    1.03897e+002    19
    51     52    2.38748e-002    1.03897e+002    19
    52     53    2.89620e-002    1.03897e+002    19
    53     54    2.29306e-002    1.03896e+002    19
    54     55    1.92724e-002    1.03896e+002    18
    55     56    1.64287e-002    1.03896e+002    18
    56     57    2.15358e-002    1.03896e+002    18
    57     58    3.61315e-002    1.03896e+002    18
    58     59    2.38579e-002    1.03896e+002    18
    59     60    1.77379e-002    1.03896e+002    18
    60     61    1.11715e-002    1.03896e+002    18
    61     62    1.56805e-002    1.03896e+002    18
    62     63    2.16188e-002    1.03896e+002    18
    63     64    1.13293e-002    1.03896e+002    18
    64     65    1.16654e-002    1.03896e+002    18
    65     66    1.61704e-002    1.03896e+002    18
    66     67    1.94607e-002    1.03896e+002    18
    67     68    1.25376e-002    1.03896e+002    18
    68     69    6.44292e-003    1.03896e+002    18
    69     70    5.58459e-003    1.03896e+002    18
    70     71    1.01714e-002    1.03896e+002    18
    71     72    1.96855e-002    1.03896e+002    18
    72     73    2.56978e-002    1.03896e+002    18
    73     74    2.27542e-002    1.03896e+002    18
    74     75    1.23896e-002    1.03896e+002    18
    75     76    8.69518e-003    1.03896e+002    18
    76     77    1.69122e-002    1.03896e+002    18
    77     78    2.40912e-002    1.03896e+002    18
    78     79    2.29505e-002    1.03896e+002    18
    79     80    1.90880e-002    1.03896e+002    18
    80     81    2.08989e-002    1.03896e+002    18
    81     82    2.73330e-002    1.03896e+002    18
    82     83    1.64858e-002    1.03896e+002    18
    83     84    8.11005e-003    1.03896e+002    18
    84     85    5.44707e-003    1.03896e+002    19
    85     86    1.02492e-002    1.03896e+002    19
    86     87    1.83781e-002    1.03896e+002    18
    87     88    7.38725e-003    1.03896e+002    18
    88     89    9.30445e-003    1.03896e+002    18
    89     90    2.93267e-003    1.03896e+002    18
    90     91    1.13150e-002    1.03896e+002    18
    91     92    1.27957e-002    1.03896e+002    18
    92     93    1.36758e-002    1.03896e+002    18
    93     94    9.30247e-003    1.03896e+002    18
    94     95    6.99457e-003    1.03896e+002    18
    95     96    7.29922e-003    1.03896e+002    18
    96     97    7.27813e-003    1.03896e+002    18
    97     98    6.99607e-003    1.03896e+002    18
    98     99    6.03413e-003    1.03896e+002    18
    99    100    6.24722e-003    1.03896e+002    18
   100    101    7.12219e-003    1.03896e+002    18
   101    102    6.94747e-003    1.03896e+002    18
   102    103    5.45565e-003    1.03896e+002    18
   103    104    4.04189e-003    1.03896e+002    18
   104    105    4.32610e-003    1.03896e+002    19
   105    106    7.50282e-003    1.03896e+002    19
   106    107    1.29944e-002    1.03896e+002    18
   107    108    7.79818e-003    1.03896e+002    18
   108    109    4.85910e-003    1.03896e+002    18
   109    110    4.46053e-003    1.03896e+002    18
   110    111    6.61473e-003    1.03896e+002    18
   111    112    1.17365e-002    1.03896e+002    18
   112    113    9.78152e-003    1.03896e+002    18
   113    114    7.18190e-003    1.03896e+002    18
   114    115    6.77009e-003    1.03896e+002    18
   115    116    9.49838e-003    1.03896e+002    18
   116    117    9.00744e-003    1.03896e+002    18
   117    118    6.49337e-003    1.03896e+002    18
   118    119    4.78872e-003    1.03896e+002    18
   119    120    7.03337e-003    1.03896e+002    18
   120    121    8.01583e-003    1.03896e+002    18
   121    122    8.61290e-003    1.03896e+002    18
   122    123    5.12904e-003    1.03896e+002    18
   123    124    3.05881e-003    1.03896e+002    18
Function value change too small
  iter fEvals         stepLen            f(w)  free
     1      2    1.00000e+000    1.09488e+002    91
     2      3    3.11188e+000    1.07102e+002    91
     3      4    1.57764e+000    1.06398e+002    88
     4      5    1.24672e+000    1.06026e+002    81
     5      6    1.49475e+000    1.05722e+002    75
     6      7    6.98331e-001    1.05568e+002    61
     7      8    1.69102e+000    1.05394e+002    60
     8      9    3.86124e-001    1.05332e+002    52
     9     10    9.14733e-001    1.05237e+002    51
    10     11    1.41581e+000    1.05162e+002    49
    11     12    2.80734e-001    1.05132e+002    40
    12     13    4.48001e-001    1.05087e+002    40
    13     14    5.40144e-001    1.05045e+002    40
    14     15    7.91145e-001    1.05020e+002    37
    15     16    2.11504e-001    1.05003e+002    35
    16     17    4.86676e-001    1.04992e+002    33
    17     18    2.23467e-001    1.04982e+002    33
    18     19    5.48877e-001    1.04967e+002    33
    19     20    1.71049e-001    1.04959e+002    33
    20     21    3.22172e-001    1.04949e+002    31
    21     22    6.06687e-001    1.04934e+002    30
    22     23    8.26068e-001    1.04922e+002    30
    23     24    2.08279e-001    1.04910e+002    29
    24     25    2.92961e-001    1.04898e+002    28
    25     26    1.14094e-001    1.04895e+002    26
    26     27    4.26023e-001    1.04894e+002    26
    27     28    2.11226e-001    1.04891e+002    24
    28     29    4.06970e-002    1.04890e+002    24
    29     30    1.01155e-001    1.04888e+002    23
    30     31    3.19314e-001    1.04885e+002    24
    31     32    2.32805e-001    1.04883e+002    24
    32     33    1.83383e-001    1.04881e+002    24
    33     34    2.75780e-001    1.04879e+002    23
    34     35    3.16350e-001    1.04876e+002    23
    35     36    1.06642e-001    1.04874e+002    22
    36     37    1.71017e-001    1.04872e+002    22
    37     38    1.43334e-001    1.04872e+002    22
    38     39    1.53557e-001    1.04871e+002    22
    39     40    3.56205e-001    1.04869e+002    20
    40     41    1.44376e-001    1.04866e+002    19
    41     42    4.44852e-001    1.04862e+002    19
    42     43    2.54039e-001    1.04858e+002    17
    43     44    6.71933e-002    1.04857e+002    18
    44     45    1.23906e-001    1.04856e+002    18
    45     46    1.79502e-001    1.04854e+002    17
    46     47    2.00218e-001    1.04852e+002    17
    47     48    1.81311e-001    1.04851e+002    18
    48     49    1.25936e-001    1.04850e+002    19
    49     50    7.50227e-002    1.04849e+002    19
    50     51    3.27172e-002    1.04849e+002    19
    51     52    2.81541e-002    1.04849e+002    19
    52     53    1.59606e-002    1.04848e+002    18
    53     54    5.13175e-002    1.04848e+002    18
    54     55    3.90400e-002    1.04848e+002    18
    55     56    4.28660e-002    1.04848e+002    18
    56     57    3.91208e-002    1.04848e+002    18
    57     58    7.82916e-002    1.04848e+002    18
    58     59    5.66299e-002    1.04847e+002    18
    59     60    8.91791e-002    1.04847e+002    18
    60     61    1.23313e-001    1.04846e+002    18
    61     63    5.41695e-002    1.04846e+002    17
    62     64    2.69218e-002    1.04846e+002    17
    63     65    3.95334e-002    1.04846e+002    17
    64     66    1.18937e-002    1.04846e+002    16
    65     67    4.31175e-002    1.04846e+002    16
    66     68    5.26909e-002    1.04846e+002    15
    67     69    8.59468e-002    1.04845e+002    15
    68     70    9.41880e-002    1.04845e+002    15
    69     71    7.35369e-002    1.04845e+002    15
    70     72    3.25493e-002    1.04845e+002    15
    71     74    3.19547e-002    1.04845e+002    14
    72     76    6.91111e-003    1.04844e+002    15
    73     77    2.05823e-002    1.04844e+002    14
    74     78    2.67927e-002    1.04844e+002    14
    75     79    1.21606e-002    1.04844e+002    14
    76     80    1.02774e-002    1.04844e+002    14
    77     81    2.27010e-002    1.04844e+002    14
    78     82    2.03800e-002    1.04844e+002    15
    79     83    1.56260e-002    1.04844e+002    15
    80     84    8.21531e-003    1.04844e+002    15
    81     85    5.36104e-003    1.04844e+002    14
    82     86    5.49965e-003    1.04844e+002    15
    83     87    1.00900e-002    1.04844e+002    15
    84     88    1.78737e-002    1.04844e+002    15
    85     89    2.38180e-002    1.04844e+002    15
    86     90    2.82839e-002    1.04844e+002    15
    87     91    9.23024e-003    1.04844e+002    14
    88     92    3.12325e-003    1.04844e+002    14
    89     93    5.74916e-003    1.04844e+002    14
    90     94    6.89844e-003    1.04844e+002    14
    91     95    8.06631e-003    1.04844e+002    14
    92     96    6.59286e-003    1.04844e+002    14
    93     97    7.19874e-003    1.04844e+002    14
    94     98    1.04279e-002    1.04844e+002    14
    95     99    1.52062e-002    1.04844e+002    14
    96    100    1.23171e-002    1.04844e+002    14
    97    101    5.10074e-003    1.04844e+002    14
    98    102    2.36524e-003    1.04844e+002    14
    99    103    2.39328e-003    1.04844e+002    14
   100    104    3.27838e-003    1.04844e+002    14
   101    105    4.23065e-003    1.04844e+002    14
Directional Derivative too small
  iter fEvals         stepLen            f(w)  free
     1      2    1.00000e+000    1.08510e+002   102
     2      3    3.66360e+000    1.03967e+002   102
     3      4    1.75169e+000    1.02831e+002    96
     4      5    1.53007e+000    1.02301e+002    93
     5      6    1.09608e+000    1.01954e+002    85
     6      7    1.55662e+000    1.01712e+002    82
     7      8    5.76410e-001    1.01598e+002    73
     8      9    3.18729e+000    1.01425e+002    70
     9     10    1.13384e+000    1.01264e+002    58
    10     11    5.37023e-001    1.01172e+002    58
    11     12    2.14151e+000    1.01079e+002    58
    12     13    6.16806e-001    1.01023e+002    46
    13     14    3.54066e-001    1.00964e+002    47
    14     15    2.25215e+000    1.00796e+002    45
    15     16    2.61055e-001    1.00763e+002    44
    16     17    1.26213e+000    1.00718e+002    43
    17     18    3.11855e-001    1.00686e+002    37
    18     19    4.63685e-001    1.00660e+002    37
    19     20    1.22623e+000    1.00613e+002    38
    20     21    3.75380e-001    1.00585e+002    37
    21     22    5.42578e-001    1.00575e+002    34
    22     23    2.59682e-001    1.00564e+002    30
    23     24    1.19405e-001    1.00557e+002    30
    24     25    1.55690e-001    1.00555e+002    30
    25     26    7.87208e-002    1.00553e+002    30
    26     27    3.52781e-001    1.00546e+002    29
    27     28    2.96479e-001    1.00540e+002    30
    28     29    1.47377e-001    1.00535e+002    28
    29     30    2.70715e-001    1.00529e+002    28
    30     31    7.03948e-002    1.00527e+002    27
    31     32    5.20782e-001    1.00519e+002    27
    32     33    1.96239e-001    1.00517e+002    25
    33     34    6.69869e-002    1.00517e+002    25
    34     35    1.43035e-001    1.00515e+002    25
    35     36    5.84118e-002    1.00514e+002    24
    36     37    8.80234e-002    1.00513e+002    24
    37     38    3.52038e-002    1.00513e+002    24
    38     39    6.72547e-002    1.00512e+002    23
    39     40    1.75943e-001    1.00511e+002    25
    40     41    3.28554e-001    1.00508e+002    26
    41     42    5.41602e-001    1.00505e+002    26
    42     43    5.21467e-001    1.00501e+002    24
    43     45    2.77360e-002    1.00501e+002    24
    44     46    1.73689e-001    1.00499e+002    23
    45     47    7.32176e-002    1.00498e+002    23
    46     48    3.89871e-002    1.00497e+002    22
    47     49    4.73332e-002    1.00497e+002    22
    48     50    6.64359e-002    1.00496e+002    22
    49     51    5.06340e-002    1.00496e+002    22
    50     52    8.20339e-002    1.00495e+002    21
    51     53    4.41106e-002    1.00495e+002    21
    52     54    5.03581e-002    1.00495e+002    21
    53     55    5.26620e-002    1.00494e+002    21
    54     56    4.20162e-002    1.00494e+002    21
    55     57    2.94960e-002    1.00494e+002    21
    56     58    2.09925e-002    1.00494e+002    21
    57     59    3.79449e-002    1.00494e+002    21
    58     60    6.96451e-002    1.00493e+002    21
    59     61    9.32034e-002    1.00493e+002    21
    60     62    7.67544e-002    1.00493e+002    21
    61     63    4.05164e-002    1.00493e+002    21
    62     64    3.14417e-002    1.00493e+002    21
    63     65    3.66631e-002    1.00492e+002    21
    64     66    4.93770e-002    1.00492e+002    21
    65     67    4.85283e-002    1.00492e+002    21
    66     68    4.25813e-002    1.00492e+002    21
    67     69    4.02461e-002    1.00492e+002    21
    68     70    4.78599e-002    1.00492e+002    21
    69     71    5.74947e-002    1.00491e+002    21
    70     72    6.80618e-002    1.00491e+002    21
    71     73    4.82321e-002    1.00491e+002    21
    72     74    1.20559e-001    1.00491e+002    20
    73     76    3.47840e-002    1.00491e+002    20
    74     77    6.72820e-002    1.00491e+002    21
    75     78    2.70012e-002    1.00491e+002    20
    76     79    1.66519e-002    1.00491e+002    20
    77     80    5.39028e-002    1.00491e+002    20
    78     81    7.36601e-002    1.00490e+002    21
    79     82    3.61610e-002    1.00490e+002    20
    80     83    2.11187e-002    1.00490e+002    20
    81     84    2.38086e-002    1.00490e+002    20
    82     85    1.96198e-002    1.00490e+002    20
    83     86    1.19559e-002    1.00490e+002    20
    84     87    6.77626e-003    1.00490e+002    20
    85     88    5.44228e-003    1.00490e+002    20
    86     89    8.24685e-003    1.00490e+002    20
    87     90    1.30712e-002    1.00490e+002    20
    88     91    1.66579e-002    1.00490e+002    20
    89     92    1.81545e-002    1.00490e+002    20
    90     93    1.74493e-002    1.00490e+002    20
    91     94    7.35823e-003    1.00490e+002    20
    92     95    8.09804e-003    1.00490e+002    20
    93     96    9.57089e-003    1.00490e+002    20
    94     97    1.20789e-002    1.00490e+002    20
    95     98    1.26246e-002    1.00490e+002    20
    96     99    1.43602e-002    1.00490e+002    20
    97    100    1.56546e-002    1.00490e+002    20
    98    101    1.63650e-002    1.00490e+002    20
    99    102    1.26974e-002    1.00490e+002    20
   100    103    7.97565e-003    1.00490e+002    20
   101    104    7.20738e-003    1.00490e+002    20
   102    105    1.20088e-002    1.00490e+002    20
   103    106    1.92015e-002    1.00490e+002    20
   104    107    1.75430e-002    1.00490e+002    20
   105    108    9.91721e-003    1.00490e+002    20
   106    109    9.77296e-003    1.00490e+002    20
   107    110    1.31199e-002    1.00490e+002    20
   108    111    1.92221e-002    1.00490e+002    20
   109    112    1.24837e-002    1.00490e+002    20
   110    113    5.92994e-003    1.00490e+002    20
   111    114    3.49248e-003    1.00490e+002    20
   112    115    4.54055e-003    1.00490e+002    20
   113    116    5.68931e-003    1.00490e+002    20
   114    117    5.31109e-003    1.00490e+002    20
   115    118    4.24180e-003    1.00490e+002    20
   116    119    5.89509e-003    1.00490e+002    20
   117    120    1.03614e-002    1.00490e+002    20
   118    121    1.36095e-002    1.00490e+002    20
   119    122    1.31064e-002    1.00490e+002    20
   120    123    6.91114e-003    1.00490e+002    20
   121    124    5.46346e-003    1.00490e+002    20
   122    125    7.14720e-003    1.00490e+002    20
   123    126    8.27700e-003    1.00490e+002    20
   124    127    4.33128e-003    1.00490e+002    20
Directional Derivative too small
  iter fEvals         stepLen            f(w)  free
     1      2    1.00000e+000    1.09283e+002    85
     2      3    4.15612e+000    1.05897e+002    86
     3      4    1.11532e+000    1.05472e+002    84
     4      5    1.83844e+000    1.04967e+002    81
     5      6    1.57187e+000    1.04696e+002    76
     6      7    1.50404e+000    1.04470e+002    69
     7      8    1.39433e+000    1.04294e+002    59
     8      9    8.42667e-001    1.04172e+002    53
     9     10    2.09397e+000    1.04115e+002    53
    10     11    7.73686e-001    1.04034e+002    43
    11     12    4.37299e-001    1.03984e+002    43
    12     13    1.05712e+000    1.03932e+002    43
    13     14    3.23451e-001    1.03906e+002    39
    14     15    8.77521e-001    1.03878e+002    39
    15     16    1.48734e-001    1.03861e+002    37
    16     17    2.26523e-001    1.03844e+002    37
    17     18    5.47960e-001    1.03817e+002    36
    18     19    7.22586e-001    1.03799e+002    32
    19     20    8.54339e-002    1.03792e+002    30
    20     21    9.92933e-001    1.03754e+002    29
    21     22    5.95806e-001    1.03736e+002    30
    22     23    9.34576e-001    1.03727e+002    28
    23     24    3.46252e-001    1.03719e+002    25
    24     25    1.66517e-001    1.03714e+002    25
    25     26    4.38163e-001    1.03706e+002    25
    26     27    9.51992e-001    1.03694e+002    25
    27     28    8.73097e-001    1.03686e+002    23
    28     29    1.81437e-001    1.03672e+002    20
    29     30    7.42962e-001    1.03650e+002    22
    30     31    2.36100e-001    1.03644e+002    24
    31     32    2.04973e-001    1.03641e+002    22
    32     33    8.51400e-002    1.03639e+002    21
    33     34    2.60060e-001    1.03635e+002    21
    34     35    1.17102e-001    1.03633e+002    21
    35     36    6.77727e-002    1.03632e+002    21
    36     37    1.11675e-001    1.03631e+002    21
    37     38    2.30354e-001    1.03628e+002    21
    38     39    3.49660e-001    1.03625e+002    21
    39     40    2.71827e-001    1.03623e+002    20
    40     41    6.49100e-002    1.03622e+002    19
    41     42    3.95066e-002    1.03622e+002    19
    42     43    7.31908e-002    1.03621e+002    19
    43     44    6.08593e-002    1.03621e+002    19
    44     45    8.03225e-002    1.03620e+002    19
    45     46    6.15914e-002    1.03620e+002    19
    46     47    1.34970e-001    1.03619e+002    19
    47     48    1.83858e-001    1.03619e+002    19
    48     49    2.49993e-001    1.03618e+002    19
    49     50    2.39186e-001    1.03617e+002    18
    50     51    1.35599e-001    1.03616e+002    18
    51     52    3.58387e-002    1.03616e+002    18
    52     53    2.12880e-002    1.03616e+002    18
    53     54    2.81356e-002    1.03616e+002    18
    54     55    4.10957e-002    1.03616e+002    18
    55     56    6.81124e-002    1.03616e+002    18
    56     57    1.12918e-002    1.03616e+002    17
    57     58    3.21727e-002    1.03616e+002    17
    58     59    1.36010e-002    1.03616e+002    17
    59     60    3.16140e-002    1.03615e+002    17
    60     61    3.73961e-002    1.03615e+002    17
    61     63    1.43595e-002    1.03615e+002    17
    62     64    3.18242e-002    1.03615e+002    16
    63     65    9.46935e-002    1.03615e+002    16
    64     66    5.00792e-002    1.03615e+002    17
    65     67    6.75502e-003    1.03615e+002    16
    66     68    1.21619e-002    1.03615e+002    16
    67     69    1.04219e-002    1.03615e+002    16
    68     70    1.65951e-002    1.03615e+002    16
    69     71    1.72627e-002    1.03615e+002    16
    70     72    1.02040e-002    1.03615e+002    16
    71     73    3.65582e-003    1.03615e+002    16
    72     74    2.68760e-003    1.03615e+002    16
    73     75    4.12441e-003    1.03615e+002    16
    74     76    6.63831e-003    1.03615e+002    16
    75     77    8.42741e-003    1.03615e+002    16
    76     78    1.02713e-002    1.03615e+002    16
    77     79    8.72146e-003    1.03615e+002    16
    78     80    5.55569e-003    1.03615e+002    16
    79     81    2.49611e-003    1.03615e+002    16
    80     82    2.20783e-003    1.03615e+002    16
Function value change too small
  iter fEvals         stepLen            f(w)  free
     1      2    1.00000e+000    1.09132e+002   106
     2      3    2.92475e+000    1.06490e+002   106
     3      4    1.58354e+000    1.05524e+002   103
     4      5    2.08949e+000    1.04669e+002    98
     5      6    1.37748e+000    1.04273e+002    93
     6      7    1.11367e+000    1.04076e+002    87
     7      8    1.48426e+000    1.03876e+002    78
     8      9    7.86870e-001    1.03786e+002    69
     9     10    1.52911e+000    1.03689e+002    68
    10     11    8.36042e-001    1.03618e+002    59
    11     12    6.94529e-001    1.03569e+002    59
    12     13    9.17377e-001    1.03517e+002    56
    13     14    2.93260e-001    1.03486e+002    54
    14     15    5.90603e-001    1.03446e+002    52
    15     16    6.21320e-001    1.03418e+002    49
    16     17    5.64499e-001    1.03392e+002    48
    17     18    1.43372e+000    1.03352e+002    48
    18     19    3.18193e-001    1.03332e+002    41
    19     20    2.28874e-001    1.03323e+002    41
    20     21    2.49461e-001    1.03316e+002    41
    21     22    1.77279e-001    1.03310e+002    41
    22     23    4.85846e-001    1.03295e+002    40
    23     24    2.84089e-001    1.03289e+002    40
    24     25    4.87065e-001    1.03279e+002    39
    25     26    5.89686e-001    1.03272e+002    37
    26     27    3.55027e-001    1.03267e+002    33
    27     28    1.11798e-001    1.03264e+002    35
    28     29    1.44510e-001    1.03261e+002    33
    29     30    9.06920e-002    1.03260e+002    33
    30     31    2.13383e-001    1.03257e+002    33
    31     32    3.51209e-001    1.03253e+002    34
    32     33    3.33137e-001    1.03249e+002    34
    33     34    4.04374e-001    1.03244e+002    32
    34     35    3.93785e-001    1.03241e+002    33
    35     36    1.24112e-001    1.03238e+002    31
    36     37    1.80186e-001    1.03236e+002    32
    37     38    4.19461e-001    1.03231e+002    32
    38     39    2.89532e-001    1.03230e+002    32
    39     40    1.44684e-001    1.03228e+002    30
    40     41    1.43827e-001    1.03225e+002    29
    41     42    1.47631e-001    1.03223e+002    28
    42     43    2.05116e-001    1.03222e+002    28
    43     44    5.89596e-002    1.03222e+002    28
    44     45    2.19417e-001    1.03220e+002    28
    45     46    1.89069e-001    1.03219e+002    28
    46     47    1.17127e-001    1.03219e+002    28
    47     48    6.92244e-002    1.03218e+002    27
    48     49    6.83030e-002    1.03218e+002    27
    49     50    1.29659e-001    1.03217e+002    27
    50     51    2.99368e-001    1.03215e+002    28
    51     52    4.18406e-001    1.03213e+002    28
    52     53    2.90606e-001    1.03212e+002    28
    53     54    2.13537e-001    1.03211e+002    26
    54     55    1.15471e-001    1.03210e+002    27
    55     56    1.16007e-001    1.03209e+002    25
    56     57    1.91621e-001    1.03208e+002    25
    57     58    1.29353e-001    1.03207e+002    25
    58     59    1.72822e-001    1.03206e+002    25
    59     60    2.76352e-001    1.03204e+002    27
    60     61    1.11138e-001    1.03203e+002    25
    61     62    2.66657e-001    1.03203e+002    24
    62     63    1.23349e-001    1.03202e+002    23
    63     64    3.94790e-002    1.03202e+002    23
    64     65    6.77204e-002    1.03202e+002    23
    65     66    8.20916e-002    1.03202e+002    22
    66     67    5.09564e-002    1.03201e+002    21
    67     68    8.34066e-002    1.03201e+002    21
    68     69    6.29385e-002    1.03201e+002    21
    69     70    1.08822e-001    1.03201e+002    21
    70     71    6.24856e-002    1.03200e+002    21
    71     72    4.36556e-002    1.03200e+002    21
    72     73    1.99012e-002    1.03200e+002    21
    73     74    3.73877e-002    1.03200e+002    21
    74     75    7.36906e-002    1.03200e+002    21
    75     76    5.26115e-002    1.03200e+002    20
    76     78    2.12578e-002    1.03200e+002    22
    77     80    8.69256e-003    1.03200e+002    22
    78     81    1.50339e-002    1.03200e+002    21
    79     82    7.41559e-003    1.03200e+002    21
    80     83    9.29431e-003    1.03200e+002    21
    81     84    1.24872e-002    1.03200e+002    21
    82     85    1.90681e-002    1.03200e+002    21
    83     86    1.16316e-002    1.03200e+002    21
    84     87    1.00053e-002    1.03200e+002    21
    85     88    5.84296e-003    1.03200e+002    21
    86     89    7.59431e-003    1.03200e+002    21
    87     90    9.61650e-003    1.03200e+002    21
    88     91    1.11594e-002    1.03200e+002    21
    89     92    9.84509e-003    1.03200e+002    21
    90     93    1.12835e-002    1.03200e+002    21
    91     94    1.43037e-002    1.03200e+002    21
    92     95    2.42006e-002    1.03200e+002    21
    93     96    2.82999e-002    1.03200e+002    21
    94     97    3.02340e-002    1.03200e+002    20
    95     98    2.21017e-002    1.03200e+002    20
    96     99    1.08650e-002    1.03200e+002    20
    97    100    1.00349e-002    1.03200e+002    20
    98    101    1.50963e-002    1.03200e+002    21
    99    102    2.25941e-002    1.03200e+002    21
   100    103    2.80159e-002    1.03200e+002    21
   101    104    3.50579e-002    1.03200e+002    21
   102    105    4.22184e-002    1.03199e+002    21
   103    106    3.88614e-002    1.03199e+002    21
   104    107    2.79787e-002    1.03199e+002    21
   105    108    2.14563e-002    1.03199e+002    21
   106    109    2.41176e-002    1.03199e+002    21
   107    110    3.69445e-002    1.03199e+002    21
   108    111    4.55854e-002    1.03199e+002    21
   109    112    4.33115e-002    1.03199e+002    20
   110    113    1.56841e-002    1.03199e+002    20
   111    114    2.10023e-002    1.03199e+002    20
   112    115    5.49730e-003    1.03199e+002    20
   113    116    8.95422e-003    1.03199e+002    20
   114    117    7.72298e-003    1.03199e+002    20
   115    118    9.32516e-003    1.03199e+002    20
   116    119    1.10490e-002    1.03199e+002    20
   117    120    1.41013e-002    1.03199e+002    20
   118    121    2.30760e-002    1.03199e+002    20
   119    122    3.57124e-002    1.03199e+002    20
   120    123    3.97482e-002    1.03199e+002    20
   121    124    3.61438e-002    1.03199e+002    20
   122    125    2.31839e-002    1.03199e+002    20
   123    126    1.88266e-002    1.03199e+002    20
   124    127    2.98706e-002    1.03199e+002    20
   125    128    3.27944e-002    1.03199e+002    20
   126    129    2.77342e-002    1.03199e+002    20
   127    130    2.55216e-002    1.03199e+002    20
   128    131    2.46058e-002    1.03199e+002    20
   129    132    3.38142e-002    1.03199e+002    20
   130    133    3.05469e-002    1.03199e+002    20
   131    134    2.57182e-002    1.03199e+002    20
   132    135    1.76183e-002    1.03199e+002    20
   133    137    1.56241e-002    1.03199e+002    19
   134    138    1.44193e-002    1.03199e+002    20
   135    139    8.72448e-003    1.03199e+002    19
   136    140    7.37745e-003    1.03199e+002    19
   137    142    1.15738e-003    1.03199e+002    20
Function value change too small
Elapsed time is 10.309768 seconds.
trainingErrorsSVM =
    35
Elapsed time is 0.180918 seconds.
trainingErrorsSVMlight =
    35
</pre><img vspace="5" hspace="5" src="svmBinaryClassifBishopDemo_01.png" alt=""> <img vspace="5" hspace="5" src="svmBinaryClassifBishopDemo_02.png" alt=""> <img vspace="5" hspace="5" src="svmBinaryClassifBishopDemo_03.png" alt=""> <img vspace="5" hspace="5" src="svmBinaryClassifBishopDemo_04.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.10<br></p></div><!--
##### SOURCE BEGIN #####
%% Compare SVM and kernelized logreg on synthetic 2 class data in 2d
%
%% Load  Data
% Load synthetic data generated from a mixture of 2 Gaussians. Source:
% http://research.microsoft.com/~cmbishop/PRML/webdatasets/datasets.htm
%
load bishop2class
y = Y(:);

%X = mkUnitVariance(centerCols(X));
%% Set up kernels
% We pick  hyperparameters that result in a pretty plot
lambda = 2;
rbfScale = 0.3;
gamma = 1/(2*rbfScale^2);
kernelFn = @kernelRbfSigma;
Ktrain =  kernelFn(X, X, rbfScale);

logregArgs.lambda = lambda;
logregArgs.regType = 'L2';
logregArgs.kernelFn = @kernelRbfSigma;
logregArgs.kernelParam = rbfScale; 


%[model, bestParams, cvMU, cvSigma] = svmlightFitCV(X, y); 


%% Train and test
for method=1:4
    switch method
        case 1,
            model = logregFit(X, y, logregArgs);
            fname = 'logregL2';
            predictFn = @(Xtest) logregPredict(model, Xtest);
        case 2,
            logregArgs.regType = 'L1';
            model = logregFit(X, y, logregArgs);
            SV = (abs(model.w) > 1e-5);
            fname = 'logregL1';
            predictFn = @(Xtest) logregPredict(model, Xtest);
        case 3
            C = 1/lambda;
            tic
            model = svmFit(X, y,'kernel', kernelFn,'C', C, 'kernelParam', rbfScale);
            toc
            fname = 'SVM';
            predictFn = @(Xtest) svmPredict(model, Xtest);
            yhat = svmPredict(model, X);
            trainingErrorsSVM = sum(yhat ~= convertLabelsToPM1(y))
            SVsvm = model.svi;
        case 4
            C = 1 / lambda;
            gamma = 1/(2*rbfScale^2);
            tic
            modelLight = svmFit(X, y,'C', C,'kernel', 'rbf', 'kernelParam', gamma, 'fitFn', @svmlightFit); 
            toc
            SV = modelLight.svi; 
            fname = 'SVMlight';
            predictFn = @(Xtest)svmPredict(modelLight, Xtest); 
            yhat = svmPredict(modelLight, X); 
            trainingErrorsSVMlight = sum(yhat ~= convertLabelsToPM1(y))
    end
    % Plot results
    plotDecisionBoundary(X, y, predictFn, 'symbols', '+x');
    if method > 1 
        plot(X(SV,1), X(SV,2), 'ok', 'linewidth', 1.5, 'markersize', 12);
    end
    title(sprintf('%s', fname))
    printPmtkFigure(sprintf('svmBinaryClassifDemo%s', fname))
end





##### SOURCE END #####
--></body></html>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>pagerankDemoPmtk</title><meta name="generator" content="MATLAB 7.10"><meta name="date" content="2010-05-01"><meta name="m-file" content="pagerankDemoPmtk"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">6 node web example</a></li><li><a href="#3">Now run it on the Harvard web site</a></li></ul></div><pre class="codeinput"><span class="comment">% Demo of the pagerank algorithm, based on code by Cleve Moler</span>
<span class="comment">% See also pagerankDemoMoler, pagerankDemoGui, surfer, pagerankpow</span>
</pre><h2>6 node web example<a name="2"></a></h2><pre class="codeinput">i = [ 2 6 3 4 4 5 6 1 1];
j = [ 1 1 2 2 3 3 3 4 6];
n = 6;
G  = sparse(i,j,1,n,n); <span class="comment">% sparse n x n matrix with 1's in specified positions</span>

c = sum(G,1);
k = find(c~=0); <span class="comment">% non zero outdegree</span>
D = sparse(k,k,1./c(k),n,n);
e = ones(n,1);
I = speye(n,n);
p = 0.85;

<span class="comment">% Find the stationary distribution</span>
pi = normalize((I - p*G*D)\e);
fprintf(<span class="string">'exact pi\n'</span>);  disp(pi(:)')

figure; bar(pi);printPmtkFigure(<span class="string">'smallwebPagerank'</span>);


<span class="comment">% Power method</span>
fprintf(<span class="string">'pi over time using power method\n'</span>);
format <span class="string">compact</span>
pi = e/n;
z = ((1-p)*(c~=0) + (c==0))/n;
A = p*G*D + e*z;
<span class="keyword">for</span> i=1:10
  pi = normalize(A*pi);
  disp(pi')
<span class="keyword">end</span>

<span class="comment">% Matrix free power method</span>
[pi,cnt] = pagerankpow(G);
fprintf(<span class="string">'matrix free power method\n'</span>); disp(pi(:)')
</pre><pre class="codeoutput">exact pi
    0.3210    0.1705    0.1066    0.1368    0.0643    0.2007
pi over time using power method
    0.3319    0.1194    0.1194    0.1667    0.0958    0.1667
    0.3219    0.1797    0.0893    0.1232    0.0724    0.2135
    0.3214    0.1721    0.1116    0.1369    0.0606    0.1974
    0.3177    0.1702    0.1067    0.1383    0.0652    0.2018
    0.3234    0.1693    0.1066    0.1368    0.0645    0.1995
    0.3200    0.1716    0.1061    0.1363    0.0643    0.2018
    0.3214    0.1701    0.1070    0.1371    0.0642    0.2002
    0.3208    0.1707    0.1064    0.1367    0.0644    0.2010
    0.3212    0.1704    0.1067    0.1368    0.0643    0.2006
    0.3209    0.1706    0.1065    0.1368    0.0643    0.2008
matrix free power method
    0.3210    0.1706    0.1066    0.1368    0.0643    0.2008
</pre><img vspace="5" hspace="5" src="pagerankDemoPmtk_01.png" alt=""> <h2>Now run it on the Harvard web site<a name="3"></a></h2><pre class="codeinput">load <span class="string">harvard500</span>
figure;spy(G);
printPmtkFigure(<span class="string">'harvard500spy'</span>);
tic
[pi,cnt] = pagerankpow(G);
toc
figure;bar(pi);set(gca,<span class="string">'xlim'</span>,[-10 510]);set(gca,<span class="string">'ylim'</span>,[0 0.02])
printPmtkFigure(<span class="string">'harvard500pagerank'</span>);
[pi,ndx] = sort(pi, <span class="string">'descend'</span>);
celldisp(U(ndx(1:3)))
</pre><pre class="codeoutput">Elapsed time is 0.036967 seconds.
ans{1} =
http://www.harvard.edu
ans{2} =
http://www.hbs.edu
ans{3} =
http://search.harvard.edu:8765/custom/query.html
</pre><img vspace="5" hspace="5" src="pagerankDemoPmtk_02.png" alt=""> <img vspace="5" hspace="5" src="pagerankDemoPmtk_03.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.10<br></p></div><!--
##### SOURCE BEGIN #####
% Demo of the pagerank algorithm, based on code by Cleve Moler
% See also pagerankDemoMoler, pagerankDemoGui, surfer, pagerankpow

%% 6 node web example
i = [ 2 6 3 4 4 5 6 1 1];
j = [ 1 1 2 2 3 3 3 4 6];
n = 6;
G  = sparse(i,j,1,n,n); % sparse n x n matrix with 1's in specified positions

c = sum(G,1);
k = find(c~=0); % non zero outdegree
D = sparse(k,k,1./c(k),n,n);
e = ones(n,1);
I = speye(n,n);
p = 0.85;

% Find the stationary distribution
pi = normalize((I - p*G*D)\e);
fprintf('exact pi\n');  disp(pi(:)')

figure; bar(pi);printPmtkFigure('smallwebPagerank'); 


% Power method
fprintf('pi over time using power method\n');
format compact
pi = e/n;
z = ((1-p)*(c~=0) + (c==0))/n;
A = p*G*D + e*z;
for i=1:10
  pi = normalize(A*pi); 
  disp(pi')
end

% Matrix free power method
[pi,cnt] = pagerankpow(G);
fprintf('matrix free power method\n'); disp(pi(:)')


%% Now run it on the Harvard web site
load harvard500
figure;spy(G);
printPmtkFigure('harvard500spy'); 
tic
[pi,cnt] = pagerankpow(G);
toc
figure;bar(pi);set(gca,'xlim',[-10 510]);set(gca,'ylim',[0 0.02])
printPmtkFigure('harvard500pagerank'); 
[pi,ndx] = sort(pi, 'descend');
celldisp(U(ndx(1:3)))




##### SOURCE END #####
--></body></html>
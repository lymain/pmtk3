
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>Baseball Batting Average Shrinkage Estimates</title><meta name="generator" content="MATLAB 7.10"><meta name="date" content="2010-05-24"><meta name="m-file" content="shrinkageDemoBaseball"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h1>Baseball Batting Average Shrinkage Estimates</h1><!--introduction--><p>Reproduce example from "Data Analysis Using Stein's Estimator and its Generalizations" Bradley Efron; Carl Morris JASA Vol. 70, No. 350. (Jun., 1975), pp. 311-319.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Data</a></li><li><a href="#2">Data Transformation</a></li><li><a href="#3">Plot Shrinkage Estimates</a></li><li><a href="#4">Histograms</a></li></ul></div><h2>Data<a name="1"></a></h2><p>1970 batting averages for 18 major league players. first column = batting average for first 45 at bats 2nd column   = batting everage for remainder of season</p><pre class="codeinput">data = [0.400 0.346;
     0.378 0.298
     0.356 0.276
     0.333 0.222
     0.311 0.273
     0.311 0.270
     0.289 0.263
     0.267 0.210
     0.244 0.269
     0.244 0.230
     0.222 0.264
     0.222 0.256
     0.222 0.303
     0.222 0.264
     0.222 0.226
     0.200 0.285
     0.178 0.316
     0.156 0.200];
</pre><h2>Data Transformation<a name="2"></a></h2><pre class="codeinput">Y = data(:,1);
p = data(:,2);
n = 45;
x = sqrt(n)*asin(2*Y-1); <span class="comment">% arcsin transform</span>
d = length(x);
xbar = mean(x);
V    = sum((x-xbar).^2);
s2   = V/d;
<span class="comment">%B = (d-3)/V;% Efron-Morris shrinkage</span>
sigma2 = 1; <span class="comment">% by construction of the arcsin transform</span>
B = sigma2/(sigma2 + max(0, s2-sigma2)); <span class="comment">% EB</span>
shrunkTransformed = xbar + (1-B)*(x-xbar);
shrunk = 0.5*(sin(shrunkTransformed/sqrt(n))+1); <span class="comment">% untransform</span>
</pre><h2>Plot Shrinkage Estimates<a name="3"></a></h2><pre class="codeinput">figure;
plot(Y, ones(1, d) ,<span class="string">'o'</span>);
hold <span class="string">on</span>
plot(shrunk, 0*ones(1, d), <span class="string">'o'</span>);
<span class="keyword">for</span> i=1:d
  line([Y(i); shrunk(i)], [1; 0]);
<span class="keyword">end</span>
title(<span class="string">'MLE (top) and shrinkage estimates (bottom)'</span>)
printPmtkFigure <span class="string">shrinkageDemoBaseballParams</span>;
</pre><img vspace="5" hspace="5" src="shrinkageDemoBaseball_01.png" alt=""> <h2>Histograms<a name="4"></a></h2><pre class="codeinput">figure;
ndx = 1:5;
h = bar([p(ndx)';
Y(ndx)'; shrunk(ndx)']');
legend({<span class="string">'true'</span>, <span class="string">'MLE'</span>, <span class="string">'shrunk'</span>})
[im_hatch, colorlist] = applyhatch_pluscolor(gcf,<span class="string">'\-x.'</span>, 1);
title(sprintf(<span class="string">'MSE MLE = %6.4f, MSE shrunk = %6.4f'</span>, mse(p,Y), mse(p,shrunk)));
printPmtkFigure <span class="string">shrinkageDemoBaseballPred</span>;
</pre><img vspace="5" hspace="5" src="shrinkageDemoBaseball_02.png" alt=""> <img vspace="5" hspace="5" src="shrinkageDemoBaseball_03.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.10<br></p></div><!--
##### SOURCE BEGIN #####
%% Baseball Batting Average Shrinkage Estimates
% Reproduce example from
% "Data Analysis Using Stein's Estimator and its Generalizations"
% Bradley Efron; Carl Morris JASA Vol. 70, No. 350. (Jun., 1975), pp.
% 311-319.
%% Data
% 1970 batting averages for 18 major league players. 
% first column = batting average for first 45 at bats
% 2nd column   = batting everage for remainder of season
data = [0.400 0.346;
     0.378 0.298
     0.356 0.276
     0.333 0.222
     0.311 0.273
     0.311 0.270
     0.289 0.263
     0.267 0.210
     0.244 0.269
     0.244 0.230
     0.222 0.264
     0.222 0.256
     0.222 0.303
     0.222 0.264
     0.222 0.226
     0.200 0.285
     0.178 0.316
     0.156 0.200];
%% Data Transformation
Y = data(:,1);
p = data(:,2);
n = 45;
x = sqrt(n)*asin(2*Y-1); % arcsin transform
d = length(x);
xbar = mean(x);
V    = sum((x-xbar).^2);
s2   = V/d;
%B = (d-3)/V;% Efron-Morris shrinkage
sigma2 = 1; % by construction of the arcsin transform
B = sigma2/(sigma2 + max(0, s2-sigma2)); % EB
shrunkTransformed = xbar + (1-B)*(x-xbar); 
shrunk = 0.5*(sin(shrunkTransformed/sqrt(n))+1); % untransform

%% Plot Shrinkage Estimates
figure;
plot(Y, ones(1, d) ,'o');
hold on
plot(shrunk, 0*ones(1, d), 'o');
for i=1:d
  line([Y(i); shrunk(i)], [1; 0]);
end
title('MLE (top) and shrinkage estimates (bottom)')
printPmtkFigure shrinkageDemoBaseballParams; 
%% Histograms
figure;
ndx = 1:5;
h = bar([p(ndx)'; 
Y(ndx)'; shrunk(ndx)']');
legend({'true', 'MLE', 'shrunk'})
[im_hatch, colorlist] = applyhatch_pluscolor(gcf,'\-x.', 1);
title(sprintf('MSE MLE = %6.4f, MSE shrunk = %6.4f', mse(p,Y), mse(p,shrunk)));
printPmtkFigure shrinkageDemoBaseballPred; 

##### SOURCE END #####
--></body></html>
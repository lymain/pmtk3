
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>rbfNetworkSarcosDemo</title><meta name="generator" content="MATLAB 7.10"><meta name="date" content="2010-07-27"><meta name="m-file" content="rbfNetworkSarcosDemo"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">RBF Network Demo</a></li><li><a href="#2">standard linear regression on response 1 - sanity check</a></li><li><a href="#3">ridge</a></li><li><a href="#4">RBF</a></li></ul></div><h2>RBF Network Demo<a name="1"></a></h2><pre class="codeinput"><span class="comment">%PMTKslow</span>
<span class="comment">%%s</span>

 loadData(<span class="string">'sarcosData'</span>)
 setSeed(0);

 <span class="comment">% Standardize the inputs so they have zero mean and unit variance on the</span>
 <span class="comment">% training set and standardize the test set accordingly using mu and sigma</span>
 <span class="comment">% of training set</span>
 [Xtrain, mu, sigma] = standardizeCols(Xtrain);
 Xtest = standardizeCols(Xtest, mu, sigma);
 assert(approxeq(mean(Xtrain),zeros(1,size(Xtrain,2))));
 assert(approxeq(sqrt(var(Xtrain)),ones(1,size(Xtrain,2))));

 <span class="comment">% center the outputs so they have zero mean on the training set and center</span>
 <span class="comment">% the test test response accordingly using mu of y training set</span>
 [ytrain mu_ytrain] = centerCols(ytrain);
 ytest = centerCols(ytest,mu_ytrain);

 Ntrain = size(Xtrain,1);
 Ntest = size(Xtest,1);

 <span class="comment">% now compute the variance of the output computed on the training set</span>
 <span class="comment">% since it already centered, y_bar = 0;</span>
 sigma2 = var(ytrain,1);
</pre><h2>standard linear regression on response 1 - sanity check<a name="2"></a></h2><pre class="codeinput"> w = linregFitL2QR(Xtrain,ytrain(:,1),0);
 ypred = Xtest*w;
 SMSE_OLS = sum((ytest(:,1)-ypred).^2)/(Ntest*sigma2(1))

 <span class="keyword">if</span> 1
 <span class="comment">% Use unsupervised clustering on a subset of the data to define prototypes</span>
 <span class="comment">% for subsequent use in an RBF network</span>
 perm = randperm(Ntrain);
 K = 100;
 prototypes = kmeansFit(Xtrain(perm(1:5000), :), K);
 <span class="keyword">end</span>

 sigma = 25; <span class="comment">% quite sensitive to this</span>
 Ktrain = kernelRbfSigma(Xtrain, prototypes', sigma);
 Ktest = kernelRbfSigma(Xtest, prototypes', sigma);

 trainSize = [10000, 20000, 30000, Ntrain];
 nout = 7;
 Dridge = size(Xtrain,2);
 Drbf = size(Ktrain,2);
 wSaveRidge = zeros(Dridge+1, nout);
 wSaveRbf = zeros(Drbf+1, nout);
 <span class="keyword">for</span> traini = 1:length(trainSize)
   ntrain = trainSize(traini);
   <span class="keyword">for</span> j=1:nout
</pre><h2>ridge<a name="3"></a></h2><pre class="codeinput">     lambda = 1;
     model = linregFit(Xtrain(1:ntrain,:), ytrain(1:ntrain,j), <span class="string">'regtype'</span>, <span class="string">'L2'</span>, <span class="string">'lambda'</span>, lambda);
     ypred = linregPredict(model, Xtest);
     SMSE_ridge(traini,j) = sum((ytest(:,j)-ypred).^2)/(Ntest*sigma2(j))
     wSaveRidge(:,j) = model.w(:);
</pre><pre class="codeoutput">SMSE_ridge =
   0.236246682718307
</pre><pre class="codeoutput">SMSE_ridge =
   0.236246682718307   0.285350504910436
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
  Column 3
   0.303179181242582
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
  Columns 3 through 4
   0.303179181242582   0.079277152878582
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
  Columns 3 through 4
   0.303179181242582   0.079277152878582
  Column 5
   0.327166853117551
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
  Columns 3 through 4
   0.303179181242582   0.079277152878582
  Columns 5 through 6
   0.327166853117551   1.268790112163907
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
  Columns 3 through 4
   0.303179181242582   0.079277152878582
  Columns 5 through 6
   0.327166853117551   1.268790112163907
  Column 7
   0.464355507029392
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758                   0
  Columns 3 through 4
   0.303179181242582   0.079277152878582
                   0                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
                   0                   0
  Column 7
   0.464355507029392
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
  Columns 3 through 4
   0.303179181242582   0.079277152878582
                   0                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
                   0                   0
  Column 7
   0.464355507029392
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
                   0                   0
  Column 7
   0.464355507029392
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
  Columns 5 through 6
   0.327166853117551   1.268790112163907
                   0                   0
  Column 7
   0.464355507029392
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753                   0
  Column 7
   0.464355507029392
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
  Column 7
   0.464355507029392
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
  Column 7
   0.464355507029392
   0.075160926421524
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842                   0
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
                   0                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
                   0                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888                   0
  Column 7
   0.464355507029392
   0.075160926421524
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
  Column 7
   0.464355507029392
   0.075160926421524
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021                   0
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
                   0                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021   0.100950419149243
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
                   0                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021   0.100950419149243
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
   0.091810467186689                   0
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021   0.100950419149243
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
   0.091810467186689   0.051307033676892
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
                   0                   0
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021   0.100950419149243
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
   0.091810467186689   0.051307033676892
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
   0.141328347485141                   0
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021   0.100950419149243
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
   0.091810467186689   0.051307033676892
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
   0.141328347485141   0.282376477358824
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
                   0
</pre><pre class="codeoutput">SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021   0.100950419149243
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
   0.091810467186689   0.051307033676892
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
   0.141328347485141   0.282376477358824
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
   0.064634380964875
</pre><h2>RBF<a name="4"></a></h2><pre class="codeinput">     lambda = 1;
     model = linregFit(Ktrain(1:ntrain,:), ytrain(1:ntrain,j), <span class="string">'regtype'</span>, <span class="string">'L2'</span>, <span class="string">'lambda'</span>, lambda);
     ypred = linregPredict(model, Ktest);
     SMSE_rbf(traini,j) = sum((ytest(:,j)-ypred).^2)/(Ntest*sigma2(j));
     wSaveRbf(:,j) = model.w(:);
</pre><pre class="codeinput">   <span class="keyword">end</span>
 <span class="keyword">end</span>

 SMSE_ridge
 SMSE_rbf

 <span class="comment">%figure;</span>
 nr = 3; nc = 2;
 <span class="keyword">for</span> j=1:nout
   figure; <span class="comment">%subplot(nr,nc,j);</span>
   hold <span class="string">on</span>
   plot(trainSize, SMSE_ridge(:,j), <span class="string">'o-'</span>, <span class="string">'linewidth'</span>, 3);
   plot(trainSize, SMSE_rbf(:,j), <span class="string">'ro:'</span>, <span class="string">'linewidth'</span>, 3);
   legend(<span class="string">'linear'</span>,<span class="string">'rbf'</span>);
   title(sprintf(<span class="string">'sarcos output %d'</span>, j))
   fname = sprintf(<span class="string">'sarcosErr%d'</span>, j);
   printPmtkFigure(fname);
   <span class="comment">%xlabel('Ntrain'); ytrain('SMSE');</span>
 <span class="keyword">end</span>


 figure; imagesc(wSaveRidge); title(<span class="string">'linear'</span>); colorbar
 figure; imagesc(wSaveRbf); title(<span class="string">'rbf'</span>); colorbar
</pre><pre class="codeoutput">SMSE_OLS =
   0.074226093033033
SMSE_ridge =
  Columns 1 through 2
   0.236246682718307   0.285350504910436
   0.095938261198758   0.118593089716825
   0.075734434922842   0.102665984067206
   0.074226099507021   0.100950419149243
  Columns 3 through 4
   0.303179181242582   0.079277152878582
   0.117809938224816   0.061519820179861
   0.092802942235250   0.054354322861967
   0.091810467186689   0.051307033676892
  Columns 5 through 6
   0.327166853117551   1.268790112163907
   0.212985244690753   0.432174070851778
   0.181317425849888   0.343257041369133
   0.141328347485141   0.282376477358824
  Column 7
   0.464355507029392
   0.075160926421524
   0.069277468872527
   0.064634380964875
SMSE_rbf =
  Columns 1 through 2
   0.981781041811102   0.972542130040668
   0.969807355647173   0.971907964101587
   0.960276597652807   0.962117851155868
   0.956716974615700   0.945944488747043
  Columns 3 through 4
   0.984243992738592   0.969309881240523
   0.962035839612849   0.955555439728203
   0.957695559797097   0.950475228065769
   0.939091632264768   0.928766792847437
  Columns 5 through 6
   0.989132051616476   1.334202466404048
   0.969796778742264   1.085048578869292
   0.977937358069220   0.992162865860459
   0.962211561243557   0.980611562820552
  Column 7
   0.985553015909566
   0.959212087424664
   0.956952122674506
   0.936828414589436
</pre><img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_01.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_02.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_03.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_04.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_05.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_06.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_07.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_08.png" alt=""> <img vspace="5" hspace="5" src="rbfNetworkSarcosDemo_09.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.10<br></p></div><!--
##### SOURCE BEGIN #####
%% RBF Network Demo
%PMTKslow
%%s
 
 loadData('sarcosData')
 setSeed(0);
 
 % Standardize the inputs so they have zero mean and unit variance on the
 % training set and standardize the test set accordingly using mu and sigma
 % of training set
 [Xtrain, mu, sigma] = standardizeCols(Xtrain);
 Xtest = standardizeCols(Xtest, mu, sigma);
 assert(approxeq(mean(Xtrain),zeros(1,size(Xtrain,2))));
 assert(approxeq(sqrt(var(Xtrain)),ones(1,size(Xtrain,2))));
 
 % center the outputs so they have zero mean on the training set and center
 % the test test response accordingly using mu of y training set
 [ytrain mu_ytrain] = centerCols(ytrain);
 ytest = centerCols(ytest,mu_ytrain);
 
 Ntrain = size(Xtrain,1);
 Ntest = size(Xtest,1);
 
 % now compute the variance of the output computed on the training set
 % since it already centered, y_bar = 0;
 sigma2 = var(ytrain,1);
 
 
 %% standard linear regression on response 1 - sanity check
 w = linregFitL2QR(Xtrain,ytrain(:,1),0);
 ypred = Xtest*w;
 SMSE_OLS = sum((ytest(:,1)-ypred).^2)/(Ntest*sigma2(1))
 
 if 1
 % Use unsupervised clustering on a subset of the data to define prototypes
 % for subsequent use in an RBF network
 perm = randperm(Ntrain);
 K = 100;
 prototypes = kmeansFit(Xtrain(perm(1:5000), :), K);
 end
 
 sigma = 25; % quite sensitive to this
 Ktrain = kernelRbfSigma(Xtrain, prototypes', sigma);
 Ktest = kernelRbfSigma(Xtest, prototypes', sigma);
 
 trainSize = [10000, 20000, 30000, Ntrain];
 nout = 7;
 Dridge = size(Xtrain,2);
 Drbf = size(Ktrain,2);
 wSaveRidge = zeros(Dridge+1, nout);
 wSaveRbf = zeros(Drbf+1, nout);
 for traini = 1:length(trainSize)
   ntrain = trainSize(traini);
   for j=1:nout
     %% ridge
     lambda = 1;
     model = linregFit(Xtrain(1:ntrain,:), ytrain(1:ntrain,j), 'regtype', 'L2', 'lambda', lambda);
     ypred = linregPredict(model, Xtest);
     SMSE_ridge(traini,j) = sum((ytest(:,j)-ypred).^2)/(Ntest*sigma2(j))
     wSaveRidge(:,j) = model.w(:);
     
     %% RBF
     lambda = 1;
     model = linregFit(Ktrain(1:ntrain,:), ytrain(1:ntrain,j), 'regtype', 'L2', 'lambda', lambda);
     ypred = linregPredict(model, Ktest);
     SMSE_rbf(traini,j) = sum((ytest(:,j)-ypred).^2)/(Ntest*sigma2(j));
     wSaveRbf(:,j) = model.w(:);
   end
 end
 
 SMSE_ridge
 SMSE_rbf
  
 %figure;
 nr = 3; nc = 2;
 for j=1:nout
   figure; %subplot(nr,nc,j);
   hold on
   plot(trainSize, SMSE_ridge(:,j), 'o-', 'linewidth', 3);
   plot(trainSize, SMSE_rbf(:,j), 'ro:', 'linewidth', 3);
   legend('linear','rbf');
   title(sprintf('sarcos output %d', j))
   fname = sprintf('sarcosErr%d', j);
   printPmtkFigure(fname);
   %xlabel('Ntrain'); ytrain('SMSE');
 end

 
 figure; imagesc(wSaveRidge); title('linear'); colorbar
 figure; imagesc(wSaveRbf); title('rbf'); colorbar
 
 
##### SOURCE END #####
--></body></html>